(window.openRenderLibJsonp=window.openRenderLibJsonp||[]).push([[3],{162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=g(n(80)),i=g(n(98)),a=n(81),r=n(89),d=g(n(164)),l=n(244),s=g(n(651)),f=n(245),p=n(144),m=n(510);function g(e){return e&&e.__esModule?e:{default:e}}var u=a.Error.NetworkErrorMessage,c=window.API,h=c.env,x=c.Bus,v=c.Echo,y=c.historyBack,I=c.sessionController,T=h.get;t.default={data:function(){return{defaultImg:a.IMG.placeholder,loading:a.IMG.loading,shopId:T("shopId"),shopType:T("shopType"),supplyShopId:T("supplyShopId"),pageNum:0,limitStart:0,fxOffset:0,wdOffset:0,url:"",allItemId:[],itemLoading:!1,nextPage:null,cacheHistory:y&&y.isTargetBrowser,SessionStorageName:"comLib-item-"+(this.model.id||0)+"-"+(this.model.cate_id||0),isPC:T("isPC")}},watch:{"model.sort":function(e){this.initData()},template:function(e){"rt"===this.env&&e&&"rank"==e.tptId&&((0,s.default)(e,d.default),(0,f.AdaptLoadMore)(e,window.API.SkinDataPicker))}},created:function(){this.initData()},methods:{mergeData:function(){if(!this.template)return!1;var e=this.getUsedData(this.model);if(e){var t=JSON.parse((0,o.default)(this.template));return"edit"!==this.env&&this.setDataTemplate&&this.setDataTemplate(t),this.processModule(t,e),t=(0,m.AdaptItemTags)(t,e)}console.log("数据为空："+(0,o.default)(this.model))},initData:function(){if(this.limitStart=0,window.API.urlQuery("mock")||"rt"===this.env&&!this.isRenderCom&&!this.model.isMock){var e=this,t=e.model,n=t.recommend,o=t.cate_id,i=t.page_size,a=!1;if(e.cacheHistory){var r=I.getItem(e.SessionStorageName);r&&r.content&&r.content.length&&(e.model.content=r.content,e.pageNum=r.pageNum,e.limitStart=r.limitStart,e.fxOffset=r.fxOffset,e.wdOffset=r.wdOffset,e.model.hasMore=r.hasMore,e.allItemId=r.allItemId&&r.allItemId.split(",")||[],a=!0)}if(1===Number(n))e.nextPage=function(){e.getRecommendItems(e.pageNum)},a||(e.model.content=[],e.nextPage());else if(0===o||o)e.nextPage=function(t){e.getCategoryItems(o,e.limitStart,parseInt(t)||void 0,e.model.sort)},a||(e.model.content=[],e.nextPage(parseInt(i)||20));else{e.nextPage=function(){var t=50*e.pageNum,n=t+50;e.getMixItemsByIds(e.allItemId.slice(t,n),function(){e.model.hasMore=n<e.allItemId.length-1})},a||(e.allItemId=e.model.content&&e.model.content.reduce(function(e,t){return t&&(t.id||t.itemId)&&e.push(t.id||t.itemId),e},[]),e.model.content=[],e.nextPage())}}},setDataTemplate:function(e){"rank"==e.tptId&&(0,s.default)(e,d.default),(0,r.setDataTemplate)({template:e,customModuleStyleOption:d.default,model:this.model,pageStyle:this.pageStyle}),this.isPC&&this.$set(this.model,"moduleDefaultStyle",JSON.parse((0,o.default)(d.default)))},getMixItemsByIds:function(e,t,n){var o=this;if(!e||!e.length)return o.itemLoading=!1,t();(0,l.GetItemList)((0,p.getShopDetailCtx)(o.model),o.model.section_id,{shopId:o.shopId,itemList:e}).then(function(e){var n=e.result;if(o.itemLoading=!1,n&&n.itemList&&n.itemList.length){var i=n.itemList.map(function(e){return e.versionNew=n.versionNew,e});o.model.content=o.model.content.concat(i.filter(function(e){return 1===e.status})),o.$nextTick(v.render),t instanceof Function&&t()}})},getCategoryItems:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.MAX_ITEM_NUM,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(void 0===e)return!1;var i=this,r=i.shopId,d=i.fxOffset,s=i.wdOffset;i.networkErrorHandler;(0,l.GetCateItemList)((0,p.getShopDetailCtx)(i.model),i.model.section_id,{shopId:r,cateId:e,wdOffset:s,fxOffset:d,limitStart:t,limitNum:n,sort:o}).then(function(e){var t=e.result;if(i.itemLoading=!1,!t||!t.itemList)return!1;i.limitStart+=n,i.model.hasMore=t.itemList.length===n,i.fxOffset=t.fxOffset,i.wdOffset=t.wdOffset;var o=t.itemList.map(function(e){return e.versionNew=t.versionNew,e});i.model.content=i.model.content.concat(o),i.$nextTick(function(){v.render(),i.updateSessionStorage()})})},getRecommendItems:function(){var e=this,t=e.shopId,n=e.pageNum;e.networkErrorHandler;(0,l.GetRecommendItemList)((0,p.getShopDetailCtx)(e.model),e.model.section_id,{shopId:t,pageNum:n,pageSize:a.MAX_ITEM_NUM}).then(function(t){var n=t.result;if(e.itemLoading=!1,!n||!n.itemList)return!1;e.model.hasMore=n.itemList.length===a.MAX_ITEM_NUM;var o=n.itemList.map(function(e){return e.versionNew=n.versionNew,e});e.model.content=e.model.content.concat(o),e.$nextTick(function(){v.render(),e.updateSessionStorage()})})},loadMoreItems:function(){var e=this;e.pageNum++,e.itemLoading=!0,e.model.hasMore=!0,e.nextPage instanceof Function?e.nextPage():e.$emit("nextPage",{pageNum:e.pageNum,hideLoading:function(){e.itemLoading=!1}})},getItemLink:function(e){return i.default.getItemLink(e.id)},networkErrorHandler:function(){this.itemLoading=!1,this.pageNum?(this.pageNum--,this.model.hasMore=!1,x.emit("showToast",{content:u})):this.model.content=[]},updateSessionStorage:function(){if(this.cacheHistory){var e=this.SessionStorageName,t=this.model,n=this.pageNum,o=this.limitStart,i=this.fxOffset,a=this.wdOffset;I.setItem(e,{content:t.content,pageNum:n,limitStart:o,fxOffset:i,wdOffset:a,hasMore:t.hasMore?"1":"",allItemId:t.allItemId})}}}}},165:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(105),a=(o=i)&&o.__esModule?o:{default:o};t.findItemsFromTemplate=function(e){if(e&&e.nodes){var t=!0,n=!1,o=void 0;try{for(var i,r=(0,a.default)(e.nodes);!(t=(i=r.next()).done);t=!0){var d=i.value;if("list"===d.type)return d.nodes}}catch(e){n=!0,o=e}finally{try{!t&&r.return&&r.return()}finally{if(n)throw o}}}return[]},t.findRelationFromNodes=function(e,t){if(!e||!e.length)return!1;for(var n=0;n<e.length;n++){var o=e[n];if(o.relation&&o.relation.value===t)return{node:o,index:n}}}},510:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdaptItemTags=function(e,t,n){var p=e.tptId;if(-1!==["two-columns","album-two-columns"].indexOf(p)){var m=(0,o.findItemsFromTemplate)(e),g=t.content;m.forEach(function(e,t){var n=g[t];if(f(e.nodes),n.hideItemTag)return!1;var p=(0,i.genTagCellNode)(),m=(0,o.findRelationFromNodes)(e.nodes,"itemName"),u=m.node,c=m.index,h=u.style;r(h);var x=p.style;d(x,h,4);var v=(0,o.findRelationFromNodes)(e.nodes[c+1].nodes,"priceInt"),y=v.node,I=(0,o.findRelationFromNodes)(e.nodes[c+2].nodes,"originalPrice"),T=I.node,N=n.itemTag;N&&N.forEach(function(e,t){var o=(0,a.genTagNodeByTagType)(e.tagType);l(o,n),s(o,{fontSize:h.fontSize,height:x.height,mainColor:y.style.color,color:T.style.color},t),p.nodes.push(o)}),e.nodes.splice(c+1,0,p)})}else if(-1!==["big"].indexOf(p)){var u=(0,o.findItemsFromTemplate)(e),c=t.content;u.forEach(function(e,t){var n=c[t],r=n.itemTag,d=r&&r.find(function(e){return e.tagType<=3});if(n.hideItemTag||n.tag||!d)return!1;var f=(0,i.genBigTagCellNode)(),p=(0,o.findRelationFromNodes)(e.nodes,"itemName"),m=p.node,g=p.index,u=f.style,h=m.style,x=h.lineHeight,v=h.color,y=h.fontSize,I=h.textAlign,T=h.width,N=h.height,w=h.paddingTop,S=h.paddingRight,b=h.paddingLeft;u.lineHeight=x,u.color=v,u.fontSize=y,u.width=T,u.height=N,u.paddingTop=w,u.paddingRight=S,u.paddingLeft=b;var L=(0,o.findRelationFromNodes)(f.nodes,"itemName"),C=L.node;C.attr.value=n[C.relation.value],C.attr.hide=n[C.relation.hide];var O=C.style;O.fontSize=y,O.color=v,O.lineHeight=N,O.height=parseInt(N)-4+"px",u.justifyContent={left:"flex-start",center:"center",right:"flex-end"}[I];var M=(0,o.findRelationFromNodes)(e.nodes[g+1].nodes,"priceInt"),F=M.node,_=(0,o.findRelationFromNodes)(e.nodes[g+1].nodes,"originalPrice"),P=_.node,k=r.filter(function(e){return e.tagType<=3});k&&k.forEach(function(e,t){var o=(0,a.genTagNodeByTagType)(e.tagType);l(o,n),s(o,{fontSize:h.fontSize,height:u.height,mainColor:F.style.color,color:P.style.color},t),o.style.marginRight=0,o.style.marginBottom=0,o.style.maxWidth="248px",f.nodes.unshift(o)}),e.nodes[g]=f})}else if(-1!==["one-column","album-one-column"].indexOf(p)){var h=(0,o.findItemsFromTemplate)(e),x=t.content;h.forEach(function(e,t){var n=x[t];if(f(e.nodes),n.hideItemTag)return!1;var p=(0,i.genTagCellNode)(),m=(0,o.findRelationFromNodes)(e.nodes,"itemName"),g=m.node,u=m.index,c=g.style;r(c);var h=p.style;d(h,c,6);var v=(0,o.findRelationFromNodes)(e.nodes[u+1].nodes,"priceInt"),y=v.node,I=(0,o.findRelationFromNodes)(e.nodes[u+2].nodes,"originalPrice"),T=I.node,N=n.itemTag;N&&N.forEach(function(e,t){var o=(0,a.genTagNodeByTagType)(e.tagType);l(o,n),s(o,{fontSize:c.fontSize,height:h.height,mainColor:y.style.color,color:T.style.color},t),p.nodes.push(o)}),e.nodes.splice(u+1,0,p)})}else if("three-columns"===p){var v=(0,o.findItemsFromTemplate)(e),y=t.content,I=n.get("item","two-columns"),T=(0,o.findItemsFromTemplate)(I)[0]||{},N=void 0;T.nodes&&T.nodes.find(function(e){if("cell"===e.type){var t=e.nodes.find(function(e){return"txt"===e.type&&e.relation&&"originalPrice"===e.relation.value});if(t)return N=t}}),v.forEach(function(e,t){var n=y[t];if(n.hideItemTag)return!1;var d=(0,i.genTagCellNode)(),f=(0,o.findRelationFromNodes)(e.nodes,"itemName"),p=f.node,m=f.index,g=p.style;r(g);var u=d.style;!function(e,t,n){var o=t.top,i=t.left,a=t.lineHeight,r=t.width,d=t.height,l=t.textAlign;e.position="absolute",e.top=parseInt(o)+parseInt(d)+n+"px",e.left=parseInt(i)+"px",e.paddingLeft=0,e.width=r,e.height=parseInt(a)-n+"px",e.justifyContent={left:"flex-start",center:"center",right:"flex-end"}[l]}(u,g,4);var c=(0,o.findRelationFromNodes)(e.nodes[m+1].nodes,"priceInt"),h=c.node,x=n.itemTag;x&&x.forEach(function(e,t){var o=(0,a.genTagNodeByTagType)(e.tagType);l(o,n),s(o,{fontSize:g.fontSize,height:u.height,mainColor:h.style.color,color:N.style.color},t),d.nodes.push(o)}),e.nodes.splice(m+1,0,d)})}return e};var o=n(165),i=n(511),a=n(652);function r(e){var t=e.lineHeight,n=(e.width,e.height);e.paddingLeft;e.WebkitLineClamp=void 0,e.textOverflow="ellipsis",e.whiteSpace="nowrap",e.display="block",e.height=parseInt(n)-parseInt(t)+"px"}function d(e,t,n){var o=t.lineHeight,i=t.width,a=(t.height,t.paddingLeft),r=t.textAlign;e.position="relative",e.top=n+"px",e.left=0,e.paddingLeft=parseInt(a)+"px",e.width=i,e.height=parseInt(o)-n+"px",e.justifyContent={left:"flex-start",center:"center",right:"flex-end"}[r]}function l(e,t){var n=e.attr,o=e.relation;o.value&&t[o.value]&&(n.value=t[o.value]),n.hide=t[o.hide],void 0===n.hide&&(n.hide=!0)}function s(e,t,n){var o=t.fontSize,i=t.height,a=t.mainColor,r=t.color,d=e.style,l="img"===e.type?0:1.5,s=parseInt(i),f=parseInt(o)-6+2;f<20&&(f=20);var p=parseInt(o)+6;s<p&&(p=s),d.fontSize=f+"px",d.height=p+"px",d.backgroundColor="transparent",d.borderWidth=l+"px",d.borderStyle="solid",d.borderColor="transparent";var m=window.API.isIOS()?l:0;d.lineHeight=parseInt(d.height)+m+"px",0===n&&(d.marginLeft=0);var g=e.relation;if(-1!==["tagType-1-value","tagType-2-value","tagType-3-value","tagType-interestFree-value"].indexOf(g.value))d.color=a,d.borderColor=d.color;else if("tagType-9-hide"===g.hide){var u=parseInt(d.height),c=u/34*240;d.height=u+"px",d.width=c+"px"}else-1!==["tagType-10-value","tagType-11-value"].indexOf(g.value)?d.color=a:d.color=r}function f(e){var t=(0,o.findRelationFromNodes)(e,"tag");if(!t)return!1;var n=(0,o.findRelationFromNodes)(e,"itemName").node,i=t.node,a=n.style,r=a.lineHeight,d=a.fontSize,l=(parseInt(r)-parseInt(d))/2;i.style.top=parseInt(i.style.top)-l+"px"}},511:function(e,t,n){"use strict";function o(e,t){return{type:"img",attr:{value:"https://si.geilicdn.com/img-52c500000184836f571f0a20e2c5-unadjust_240_34.png",hide:!0},style:{height:"30px",marginLeft:"16px",marginBottom:"16px",objectFit:"contain"},relation:e,extends:{}}}function i(e){return{type:"txt",attr:{value:"",hide:!0},style:{fontSize:"22px",color:"#F53939",borderRadius:"4px",padding:"0 10px",lineHeight:"30px",marginLeft:"16px",marginBottom:"16px",whiteSpace:"nowrap",boxSizing:"border-box",height:"30px",backgroundColor:"rgba(245,57,57,0.02)",border:"1px solid rgba(245,57,57,0.2)",maxWidth:"100%",textOverflow:"ellipsis",overflow:"hidden"},relation:e,extends:{}}}function a(e){return{type:"txt",attr:{value:"",hide:!0},style:{fontSize:"22px",color:"#F53939",lineHeight:"30px",marginLeft:"16px",marginBottom:"16px",whiteSpace:"nowrap",boxSizing:"border-box",height:"30px",backgroundColor:"rgba(245,57,57,0.02)",maxWidth:"100%",textOverflow:"ellipsis",overflow:"hidden"},relation:e,extends:{}}}function r(e){return{type:"txt",attr:{value:"",hide:!0},style:{fontSize:"22px",color:"#9A9A9A",lineHeight:"32px",marginLeft:"16px",marginBottom:"16px",whiteSpace:"nowrap",height:"30px",maxWidth:"100%",textOverflow:"ellipsis",overflow:"hidden"},relation:e,extends:{}}}Object.defineProperty(t,"__esModule",{value:!0}),t.genTagByTagStyleType=function(e){switch(e){case"image":return o;case"border":return i;case"mainText":return a;case"text":default:return r}},t.genTagCellNode=function(){return{type:"cell",attr:{hide:!1},style:{position:"relative",height:"30px",alignItems:"flex-start",justifyContent:"flex-start",paddingLeft:"0px",flexWrap:"wrap"},extends:{},nodes:[],relation:{hide:"hideItemTag",value:"itemTag"}}},t.genBigTagCellNode=function(){return{type:"cell",attr:{hide:!1},style:{position:"relative",alignItems:"center",justifyContent:"flex-start",flexWrap:"nowrap",textOverflow:"ellipsis"},extends:{},nodes:[{type:"txt",attr:{value:"商品标题",hide:!1},style:{position:"relative",paddingRight:"14px",paddingLeft:"14px",height:"48px",lineHeight:"44px",color:"rgba(80, 89, 89, 1)",fontSize:"32px",textAlign:"left",textOverflow:"ellipsis",wordBreak:"break-all",whiteSpace:"nowrap",overflow:"hidden",display:"inline-block",flex:"revert"},relation:{value:"itemName",textIndent:"itemNameTextIndent",hide:"hideItemName"},extends:{editable:!0}}],relation:{hide:"hideItemTag",value:"itemTag"}}}},651:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){4==e.nodes[1].nodes[0].nodes.length?t[1305].rankFontColor.expr=[{parentNode:"template['nodes'][1]['nodes'][0]['nodes'][3]",childrenIndexArr:[1],updatedCss:"color"},{parentNode:"template['nodes'][1]['nodes'][1]['nodes'][3]",childrenIndexArr:[1],updatedCss:"color"},{parentNode:"template['nodes'][1]['nodes'][2]['nodes'][3]",childrenIndexArr:[1],updatedCss:"color"}]:t[1305].rankFontColor.expr=[{parentNode:"template['nodes'][1]['nodes'][0]['nodes'][2]",childrenIndexArr:[1],updatedCss:"color"},{parentNode:"template['nodes'][1]['nodes'][1]['nodes'][2]",childrenIndexArr:[1],updatedCss:"color"},{parentNode:"template['nodes'][1]['nodes'][2]['nodes'][2]",childrenIndexArr:[1],updatedCss:"color"}]}},652:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagStyleTypeMap=void 0,t.genTagNodeByTagType=function(e){var t={value:"tagType-"+e+"-value",hide:"tagType-"+e+"-hide"};9===e&&(t.value=void 0);return(0,o.genTagByTagStyleType)(a[e]||i)(t)};var o=n(511),i="text",a=t.TagStyleTypeMap={1:"border",2:"border",3:"border",9:"image",10:"mainText",11:"mainText",interestFree:"border"}}}]);